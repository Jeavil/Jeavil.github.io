<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--Description-->
    
        <meta name="description" content="Buffering...">
    

    <!--Author-->
    
        <meta name="author" content="Jeavil">
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="ReactNativeå¼€å‘è¿‡ç¨‹ä¸­çš„é‚£äº›ç£•ç£•ç»Šç»Š"/>
    

    <!--Open Graph Description-->
    
        <meta property="og:description" content="Buffering..." />
    

    <!--Open Graph Site Name-->
    <meta property="og:site_name" content="Jeavil&#39;s Blog"/>

    <!--Type page-->
    
        <meta property="og:type" content="article" />
    

    <!--Page Cover-->
    

        <meta name="twitter:card" content="summary" />
    

    <!-- Title -->
    
    <title>ReactNativeå¼€å‘è¿‡ç¨‹ä¸­çš„é‚£äº›ç£•ç£•ç»Šç»Š - Jeavil&#39;s Blog</title>

    <!-- Bootstrap Core CSS -->
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet"/>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/style.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet" />

    <!-- Google Analytics -->
    


</head>


<body>

    <!-- Menu -->
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Configurable Title</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                
                    <li>
                        <a href="/">
                            
                                Home
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/archives">
                            
                                Archives
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="https://github.com/Jeavil/Jeavil.github.io">
                            
                                <i class="fa fa-github fa-stack-2x"></i>
                            
                        </a>
                    </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>

    <!-- Main Content -->
    <!-- Page Header -->
<!-- Set your background image for this header in your post front-matter: cover -->

<header class="intro-header" style="background-image: url('http://www.codeblocq.com/assets/projects/hexo-theme-clean-blog/img/home-bg.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>ReactNativeå¼€å‘è¿‡ç¨‹ä¸­çš„é‚£äº›ç£•ç£•ç»Šç»Š</h1>
                    
                    <span class="meta">
                        <!-- Date and Author -->
                        
                        2017-01-12
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Tags and categories -->
           

            <!-- Gallery -->
            

            <!-- Post Main Content -->
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <h1 id="ReactNativeå¼€å‘è¿‡ç¨‹ä¸­çš„é‚£äº›ç£•ç£•ç»Šç»Š"><a href="#ReactNativeå¼€å‘è¿‡ç¨‹ä¸­çš„é‚£äº›ç£•ç£•ç»Šç»Š" class="headerlink" title="ReactNativeå¼€å‘è¿‡ç¨‹ä¸­çš„é‚£äº›ç£•ç£•ç»Šç»Š"></a>ReactNativeå¼€å‘è¿‡ç¨‹ä¸­çš„é‚£äº›ç£•ç£•ç»Šç»Š</h1><p>è¿‘å‡ ä¸ªè¿­ä»£ç‰ˆæœ¬æˆ‘ä»¬å¤§iOSéƒ½æ˜¯é‡‡ç”¨react-nativeå¼€å‘çš„ï¼Œå› ä¸ºæŠ€æœ¯æ¯”è¾ƒæ–°ï¼Œå¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°å„ç§å„æ ·çš„é—®é¢˜å†æ˜¯åœ¨æ‰€éš¾å…çš„ã€‚å¿™é‡Œå·é—²ï¼Œèµ¶ç´§æŠŠé‡åˆ°çš„é—®é¢˜åŠè§£å†³æ–¹æ¡ˆåšä¸ªæ€»ç»“ï¼Œå…å¾—æ—¥ååˆå¿˜äº†ã€‚</p>
<h3 id="é—®é¢˜ä¸€ï¼š"><a href="#é—®é¢˜ä¸€ï¼š" class="headerlink" title="é—®é¢˜ä¸€ï¼š"></a>é—®é¢˜ä¸€ï¼š</h3><p>å¦‚å›¾ï¼š</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1614000-76d15837eb4793e8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æŠ¥é”™ä¿¡æ¯.png"></p>
<p>ä¸çŸ¥é“å¤§å®¶æœ‰æ²¡æœ‰é‡åˆ°è¿‡ç±»ä¼¼çš„é—®é¢˜ã€‚ä¸Šå›¾ä¸­çš„æŠ¥é”™æˆ‘æ˜¯åœ¨3.14.0ç‰ˆæœ¬çš„å¼€å‘ä¸­ç¬¬ä¸€æ¬¡é‡åˆ°ï¼Œè€å®è¯´è¿™ä¸ªé—®é¢˜å›°æ‰°äº†æˆ‘ä¸€å¤©ï¼Œæˆ‘å°è¯•äº†å„ç§æ–¹æ³•ï¼Œå¹¶ä¸”åˆ©ç”¨ Chorme è”æœºè°ƒè¯•ä¹Ÿæ²¡å‘ç°é—®é¢˜çš„æ‰€åœ¨ã€‚<br>è¿™ä¸ªé—®é¢˜å‘ç”Ÿäº†ä¸‰æ¬¡ï¼š</p>
<p>ç¬¬ä¸€æ¬¡ï¼Œæ˜¯åœ¨renderé‡Œçš„ListView ç»„ä»¶ä¸­ï¼Œåªè¦æˆ‘æ·»åŠ äº†ListViewå°±å›æŠ¥é”™ï¼Œä½†æ˜¯å°†ListViewæ›¿æ¢æˆæ™®é€šçš„Viewå°±æ²¡æœ‰é—®é¢˜äº†ï¼Œè¿™ä¸‹å¥½äº†é”å®šç›®æ ‡ï¼Œä¸€å®šæ˜¯ListViewæœ‰é—®é¢˜ï¼Œå“ªé‡Œæ²¡æœ‰é…ç½®å¥½ã€‚</p>
<p>ç¬¬äºŒæ¬¡ï¼Œå‘ç”Ÿåœ¨æ¸²æŸ“è‡ªå®šä¹‰Cellä¸­ï¼Œå’Œç¬¬ä¸€æ¬¡åœ¨ä¸€ä¸ªç±»ä¸­ã€‚</p>
<p>ç¬¬ä¸‰æ¬¡ï¼Œå‘ç”Ÿåœ¨æ¡ä»¶åˆ¤æ–­ä¸­ã€‚</p>
<p>ä¸è¦ç€æ€¥ï¼Œä¸‹é¢å¬æˆ‘ç»™ä½ å¨“å¨“é“æ¥</p>
<h4 id="æƒ…å†µä¸€ï¼š"><a href="#æƒ…å†µä¸€ï¼š" class="headerlink" title="æƒ…å†µä¸€ï¼š"></a>æƒ…å†µä¸€ï¼š</h4><p>æ¥ç²˜æ®µä»£ç çœ‹çœ‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line">render() &#123;</div><div class="line">        if (this.state.offline) &#123;</div><div class="line">            return (</div><div class="line">                &lt;GuideOfflineView /&gt;</div><div class="line">            );</div><div class="line">        &#125;</div><div class="line">        if (!this.state.data) &#123;</div><div class="line">            return (</div><div class="line">                &lt;LoadingView /&gt;</div><div class="line">            );</div><div class="line">        &#125;</div><div class="line">        return (</div><div class="line">            &lt;View style=&#123;&#123; flex: 1 &#125;&#125;&gt;</div><div class="line">                &lt;View style=&#123;&#123;</div><div class="line">                    width: App.Constant.screenWidth,</div><div class="line">                    marginTop: 30,</div><div class="line">                    marginBottom:20,</div><div class="line">                    flexDirection: &apos;row&apos;,</div><div class="line">                    alignItems: &apos;flex-start&apos;,</div><div class="line">                    justifyContent: &apos;space-between&apos;,</div><div class="line">                &#125;&#125;&gt;</div><div class="line">                    &lt;TouchableOpacity style=&#123;&#123;</div><div class="line">                        marginLeft: 20,</div><div class="line">                    &#125;&#125;</div><div class="line">                        onPress=&#123;this.onCloseBtnPress&#125;&gt;</div><div class="line">                        &lt;Image source=&#123;App.Image.btn.guideListClose&#125; /&gt;</div><div class="line">                    &lt;/TouchableOpacity&gt;</div><div class="line">                    &lt;Text style=&#123;&#123;</div><div class="line">                        fontSize: 17,</div><div class="line">                        color: App.Color.darkGray,</div><div class="line">                        textAlign: &apos;center&apos;,</div><div class="line">                    &#125;&#125;&gt;</div><div class="line">                        Title</div><div class="line">                &lt;/Text&gt;</div><div class="line">                    &lt;View style=&#123;&#123;</div><div class="line">                        marginRight: 20,</div><div class="line">                        height: 13,</div><div class="line">                        width: 13,</div><div class="line">                    &#125;&#125; /&gt;</div><div class="line">                &lt;/View&gt;</div><div class="line">                &lt;TableView</div><div class="line">                    data=&#123;this.state.data&#125;</div><div class="line">                    dataSource=&#123;this.state.dataSource&#125;</div><div class="line">                    requestData=&#123;this.loadMoreData&#125;</div><div class="line">                /&gt;</div><div class="line">            &lt;/View&gt;</div><div class="line">        );</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>è¿™é‡Œæ˜¯render()é¡µé¢ï¼Œé‡Œé¢çš„TableViewæ˜¯æˆ‘è‡ªå®šä¹‰çš„ListViewç»„ä»¶ï¼Œä¸ºäº†ä½¿ä»£ç æ›´æ¸…æ™°ï¼Œå°±æŠŠä»–æå‡ºæ¥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line">const TableView = (&#123;</div><div class="line">    style,</div><div class="line">    dataSource,</div><div class="line">    data,</div><div class="line">    requestData,</div><div class="line">&#125;) =&gt; &#123;</div><div class="line">    const loadMoreMessage = () =&gt; &#123;</div><div class="line">        if (data.items.length === data.total) &#123;</div><div class="line">            return;</div><div class="line">        &#125;</div><div class="line">        requestData();</div><div class="line">    &#125;;</div><div class="line">    if (dataSource === undefined || dataSource.getRowCount() === 0) &#123;</div><div class="line">        return (</div><div class="line">            &lt;View style=&#123;&#123;</div><div class="line">                flex: 1,</div><div class="line">                alignItems: &apos;center&apos;,</div><div class="line">                justifyContent: &apos;center&apos;,</div><div class="line">            &#125;&#125;&gt;</div><div class="line">                &lt;Text style=&#123;&#123;</div><div class="line">                    alignItems: &apos;center&apos;,</div><div class="line">                    justifyContent: &apos;center&apos;,</div><div class="line">                    fontSize: 14,</div><div class="line">                    color: App.Color.darkGray,</div><div class="line">                &#125;&#125;&gt;</div><div class="line">                    æš‚æ— äº‘å¯¼æ¸¸</div><div class="line">                &lt;/Text&gt;</div><div class="line">            &lt;/View&gt;</div><div class="line">        );</div><div class="line">    &#125; else &#123;</div><div class="line">        return &lt;ListView</div><div class="line">            opacity=&#123;1&#125;</div><div class="line">            dataSource=&#123;dataSource&#125;</div><div class="line">            renderRow=&#123;GuideListCell&#125;</div><div class="line">            showVerticalScrollIndicator=&#123;false&#125;</div><div class="line">            enableEmptySections=&#123;true&#125;</div><div class="line">            onEndReached=&#123;() =&gt; &#123; loadMoreMessage(); &#125; &#125;</div><div class="line">            onEndReachedThreshold=&#123;20&#125;</div><div class="line">            renderSeparator=&#123;(sectionID, rowID) =&gt; &#123;</div><div class="line">                return (</div><div class="line">                    &lt;View</div><div class="line">                        key=&#123;`$&#123;sectionID&#125;-$&#123;rowID&#125;`&#125;</div><div class="line">                        style=&#123;&#123;</div><div class="line">                            height: 0,</div><div class="line">                            width: App.Constant.screenWidth,</div><div class="line">                            marginTop: 20,</div><div class="line">                        &#125;&#125; /&gt;</div><div class="line">                );</div><div class="line">            &#125; &#125;</div><div class="line">            /&gt;;</div><div class="line">    &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>åœ¨ListViewä¸­é…ç½®äº† datasource å’Œè‡ªå®šä¹‰ cellï¼Œç»éªŒå‘Šè¯‰æˆ‘è¿™é‡ŒListViewå‡ºé—®é¢˜ä¸æ˜¯datasourceæœ‰é—®é¢˜å°±æ˜¯è‡ªå®šä¹‰cellåˆé—®é¢˜ã€‚</p>
<h4 id="ç¬¬ä¸€æ­¥ï¼šæ£€æŸ¥dataSource"><a href="#ç¬¬ä¸€æ­¥ï¼šæ£€æŸ¥dataSource" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼šæ£€æŸ¥dataSource"></a>ç¬¬ä¸€æ­¥ï¼šæ£€æŸ¥dataSource</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">updateDataSource(data) &#123;</div><div class="line">        if (data !== undefined) &#123;</div><div class="line">            let newData;</div><div class="line">            if (this.state.data !== undefined) &#123;</div><div class="line">                newData = this.state.data;</div><div class="line">                newData.items = this.state.data.items.concat(data.items);</div><div class="line">            &#125; else &#123;</div><div class="line">                newData = data;</div><div class="line">            &#125;</div><div class="line">            var ds = new ListView.DataSource(&#123; rowHasChanged: (r1, r2) =&gt; r1 !== r2 &#125;);</div><div class="line">            this.setState(&#123;</div><div class="line">                data: newData,</div><div class="line">                dataSource: ds.cloneWithRows(newData.items),</div><div class="line">            &#125;);</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>åœ¨æˆ‘è¯·æ±‚å®Œæ•°æ®åå¯¹ ListView çš„ datasource ä¹ŸæŒ‰è¦æ±‚è¿›è¡Œäº†é…ç½®ã€‚</p>
<blockquote>
<p>è¿™é‡Œæˆ‘æƒ³ç¨å¾®æä¸€ä¸‹ï¼šListView å¯¹å®ƒçš„ datasource æ˜¯æœ‰ä¸¥æ ¼æ ¼å¼è¦æ±‚çš„ï¼Œé¦–å…ˆ datasource å¿…é¡»æ˜¯æ•°ç»„ï¼Œè¿™æ ·å®ƒæ‰èƒ½æ ¹æ®ä¸åŒçš„ rowID æ¥å–å‡ºå¯¹åº”æ•°æ®è¿›è¡Œæ¸²æŸ“ã€‚å…¶æ¬¡ï¼Œæƒ³è¦ ListView ä½¿ç”¨ datasource å¿…é¡»è¦ç»è¿‡ <strong><em>ds.cloneWithRow(dataSource)</em></strong> æ“ä½œï¼Œè¿™æ­¥æ“ä½œä¸»è¦æ˜¯ä¸ºäº†æå–æ–°æ•°æ®å¹¶è¿›è¡Œé€è¡Œè¿›è¡Œæ¯”è¾ƒï¼Œè¿™æ ·ListViewå°±çŸ¥é“å“ªäº›è¡Œéœ€è¦é‡æ–°æ¸²æŸ“ã€‚</p>
</blockquote>
<p>æ¥æ‰“å°ä¸€ä¸‹æ•°æ®çœ‹ListViewçš„dataSourceå¯¹ä¸å¯¹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line">&apos;---&gt;&gt; dataSource&apos;, &#123; _rowHasChanged: [Function: rowHasChanged],</div><div class="line">  _getRowData: [Function: defaultGetRowData],</div><div class="line">  _sectionHeaderHasChanged: [Function],</div><div class="line">  _getSectionHeaderData: [Function: defaultGetSectionHeaderData],</div><div class="line">  _dataBlob: </div><div class="line">   &#123; s1: </div><div class="line">      [ </div><div class="line">        &#123; _id: &apos;36398d0d3c3a43cb86473f411eb4094a&apos;,</div><div class="line">          name: &apos;å°ä¸œåŒº&apos;,</div><div class="line">          weight: 12,</div><div class="line">          items: </div><div class="line">           [ &#123; _id: &apos;706b5c36479742308603788a74b6781c&apos;,</div><div class="line">               location: &#123; lat: 0, lng: 0 &#125;,</div><div class="line">               cover: &#123; source: &apos;https://image-cdn.fishsaying.com/89be2d8757cf47dbb1152abb08d765b6.jpg&apos; &#125;,</div><div class="line">               scenic_id: &apos;36398d0d3c3a43cb86473f411eb4094a&apos;,</div><div class="line">               title: &apos;ä¸œäº¬å°ä¸œåŒº å¤§å’Œé£éª¨&apos;,</div><div class="line">               weight: 12 &#125; ] &#125;,</div><div class="line">      </div><div class="line">        &#123; _id: &apos;9de32b5fffd7451883ff16e0905bb8e3&apos;,</div><div class="line">          name: &apos;æ¶©è°·&apos;,</div><div class="line">          weight: 14,</div><div class="line">          items: </div><div class="line">           [ &#123; _id: &apos;d643b686ad54426dbd22120861636dd2&apos;,</div><div class="line">               location: &#123; lat: 0, lng: 0 &#125;,</div><div class="line">               cover: &#123; source: &apos;https://image-cdn.fishsaying.com/a9f971ef9d7647a8aa7586431e7db972.jpg&apos; &#125;,</div><div class="line">               scenic_id: &apos;9de32b5fffd7451883ff16e0905bb8e3&apos;,</div><div class="line">               title: &apos;ä¸œäº¬æ¶©è°·åŒº æ—¶å°šå‰æ²¿&apos;,</div><div class="line">               weight: 14 &#125; ] &#125;,</div><div class="line">        &#123; _id: &apos;1c6eeeaa96f647e9b3afc9456ccb4e6e&apos;,</div><div class="line">          name: &apos;æ–°å®¿&apos;,</div><div class="line">          weight: 15,</div><div class="line">          items: </div><div class="line">           [ &#123; _id: &apos;0ae445cf20424c08ac12e03c500a7a46&apos;,</div><div class="line">               location: &#123; lat: 0, lng: 0 &#125;,</div><div class="line">               cover: &#123; source: &apos;https://image-cdn.fishsaying.com/d872e0876ae44481a391c17bbac76515.jpg&apos; &#125;,</div><div class="line">               scenic_id: &apos;1c6eeeaa96f647e9b3afc9456ccb4e6e&apos;,</div><div class="line">               title: &apos;ä¸œäº¬æ–°å®¿åŒº éƒ½å¸‚ä¼ è¯´&apos;,</div><div class="line">               weight: 15 &#125; ] &#125;,</div><div class="line">        &#123; _id: &apos;54cdcbb39a0b8ad439d0605c&apos;,</div><div class="line">          name: &apos;å¡”å°”å¯ºæ™¯åŒº&apos;,</div><div class="line">          weight: 21,</div><div class="line">          items: </div><div class="line">           [ &#123; _id: &apos;109e76e39d6b428a9e5c93cdc11f3367&apos;,</div><div class="line">               location: &#123; lat: 0, lng: 0 &#125;,</div><div class="line">               cover: &#123; source: &apos;https://image-cdn.fishsaying.com/485283515ff346119903fc0d000050eb.jpg&apos; &#125;,</div><div class="line">               scenic_id: &apos;54cdcbb39a0b8ad439d0605c&apos;,</div><div class="line">               title: &apos;å¡”å°”å¯ºäº‘å¯¼æ¸¸&apos;,</div><div class="line">               weight: 21 &#125; ] &#125; ] &#125;,</div><div class="line">  _dirtyRows: </div><div class="line">   [ [ true,</div><div class="line">       true,</div><div class="line">       true,</div><div class="line">       true ] ],</div><div class="line">  _dirtySections: [ true ],</div><div class="line">  _cachedRowCount: 4,</div><div class="line">  rowIdentities: [ [ &apos;0&apos;, &apos;1&apos;, &apos;2&apos;, &apos;3&apos; ] ],</div><div class="line">  sectionIdentities: [ &apos;s1&apos; ] &#125;</div></pre></td></tr></table></figure>
<p>ä¸€åˆ‡æ­£å¸¸ï¼Œæ ¼å¼æ ‡å‡†ï¼Œè¯´æ˜æ‰“dataSourceæ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚</p>
<p><strong>æ’é™¤dataSourceå‡ºé”™ã€‚</strong></p>
<h4 id="ç¬¬äºŒæ­¥ï¼šæ£€æŸ¥renderRowä¸­é…ç½®çš„Cell"><a href="#ç¬¬äºŒæ­¥ï¼šæ£€æŸ¥renderRowä¸­é…ç½®çš„Cell" class="headerlink" title="ç¬¬äºŒæ­¥ï¼šæ£€æŸ¥renderRowä¸­é…ç½®çš„Cell"></a>ç¬¬äºŒæ­¥ï¼šæ£€æŸ¥renderRowä¸­é…ç½®çš„Cell</h4><p>è¿™é‡Œæˆ‘æ‰€ä¼ è¿›å»çš„æ˜¯è‡ªå®šä¹‰çš„Cell â€“&gt; GuideListCell</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line">import React from &apos;react&apos;; // eslint-disable-line no-unused-vars</div><div class="line">import &#123;</div><div class="line">    View,</div><div class="line">    StyleSheet,</div><div class="line">&#125; from &apos;react-native&apos;;</div><div class="line"></div><div class="line">import App from &apos;.././helper/app.js&apos;;</div><div class="line">import CloudGuideContainer from &apos;./CloudGuideContainer.js&apos;;</div><div class="line"></div><div class="line">const Constants = &#123;</div><div class="line">  height: App.Constant.screenWidth * 0.58,</div><div class="line">  width: App.Constant.screenWidth - 40,</div><div class="line">&#125;;</div><div class="line"></div><div class="line">const GuideListCell = (rowData, sectionID, rowID) =&gt; &#123;</div><div class="line">   const name = rowData.name;</div><div class="line">   return (</div><div class="line">     &lt;View style = &#123;styles.container&#125;&gt;</div><div class="line">        &lt;Text style = &#123;styles.title&#125;&gt;</div><div class="line">        &#123;name&#125;</div><div class="line">        &lt;/Text&gt;</div><div class="line">      &lt;View style = &#123;styles.listContainer&#125;&gt;</div><div class="line">        &lt;CloudGuideContainer dataSource = &#123;rowData&#125; /&gt;</div><div class="line">      &lt;/View&gt;</div><div class="line">     &lt;/View&gt;</div><div class="line">);</div><div class="line">&#125;;</div><div class="line"></div><div class="line">const styles = StyleSheet.create(&#123;</div><div class="line">  container: &#123;</div><div class="line">    flex: 1,</div><div class="line">    justifyContent: &apos;flex-start&apos;,</div><div class="line">    alignItems: &apos;center&apos;,</div><div class="line">    width:Constants.width,</div><div class="line">    height:Constants.height,</div><div class="line">    marginLeft:20,</div><div class="line">  &#125;,</div><div class="line">  listContainer: &#123;</div><div class="line">    marginTop:20,</div><div class="line">    width:Constants.width,</div><div class="line">    height:Constants.height,</div><div class="line">  &#125;,</div><div class="line">  title: &#123;</div><div class="line">    width:Constants.width,</div><div class="line">    fontSize: 14,</div><div class="line">    color: App.Color.darkGray,</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">export default GuideListCell;</div></pre></td></tr></table></figure>
<p>çœ‹èµ·æ¥ä¹Ÿæ²¡æœ‰å•¥é—®é¢˜å‘€ï¼Œreload ä¸€ä¸‹è¿˜æ˜¯æŠ¥åŒæ ·çš„é”™è¯¯ï¼ŒChromeè°ƒè¯•æ–­ç‚¹åˆä¸èƒ½åœ¨returnçš„ç»„ä»¶é‡Œé¢æ‰“ï¼Œæœ€åä¼šcrashåœ¨reacté‡Œé¢çš„jsæ–‡ä»¶ä¸­ğŸ˜”è¿™è¿˜æ€ä¹ˆç©ï¼Ÿ</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1614000-592ea50ac2e841fe.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Chromeè°ƒè¯•æŠ¥é”™ä¿¡æ¯.png"></p>
<p>æ— å¥ˆä¹‹ä¸‹æˆ‘ç”¨ä¸€ä¸ªæœ€ç¬¨çš„åŠæ³•æ¥æ‰¾æŠ¥é”™åŸå› ï¼ŒæŠŠreturnæ–¹æ³•ä¸­çš„æ‰€æœ‰ä»£ç éƒ½æ³¨é‡Šæ‰ï¼Œåªç•™ä¸€ä¸ª<view>ç»™è¿™ä¸ªViewä¸€ä¸ªèƒŒæ™¯è‰²ï¼Œæœç„¶è¿™æ ·ListViewå‡ºæ¥äº†ï¼Œä¸æŠ¥é”™äº†ğŸ˜„æ‰¾è¿™æ ·çš„æ–¹æ³•ï¼Œä¸€ä¸ªæ§ä»¶ä¸€ä¸ªæ§ä»¶çš„æ‰“å¼€ã€‚å‡ åˆ†é’Ÿçš„æ—¶é—´å°±æ‰¾åˆ°é—®é¢˜äº† â€”â€” <strong>Text</strong>ï¼Œä½ å°±æ˜¯ç½ªé­ç¥¸é¦–ã€‚å¯ä¸ºä»€ä¹ˆå‘¢ï¼Œäºæ˜¯æˆ‘ä»ç¬¬ä¸€è¡Œå¼€å§‹é‡æ–°æµè§ˆä»£ç ï¼Œç»“æœè®©æˆ‘æ¨æ¯’äº†è‡ªå·±</view></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">import &#123;</div><div class="line">    View,</div><div class="line">    StyleSheet,</div><div class="line">&#125; from &apos;react-native&apos;;</div></pre></td></tr></table></figure>
<p>è¿™é‡Œé¢å¿˜äº†import Text äº†ğŸ˜¢</p>
<p>Soï¼Œä¸è¦å¯¹Rectçš„æŠ¥é”™æœºåˆ¶æœ‰å¤ªå¤§å¹»æƒ³ï¼Œçš„ç¡®æœ‰æ—¶ä»–ä¼šæŠ¥é”™è¯´æ²¡æœ‰æ‰¾ä¸ªè¿™ä¸ªç»„ä»¶æˆ–è€…å˜é‡ï¼Œä½†æœ‰çš„æ—¶å€™äººå®¶å°±ä¼šç»™ä½ æŠ¥äº›æ‘¸ä¸ç€å¤´è„‘çš„é”™è¯¯ä¿¡æ¯ã€‚</p>
<p><strong>è‡ªå®šä¹‰Cellå‡ºäº†é—®é¢˜ï¼Œè¿™ä¸ªçŒœæµ‹æ˜¯å¯¹çš„ã€‚</strong></p>
<h4 id="æƒ…å†µäºŒï¼š"><a href="#æƒ…å†µäºŒï¼š" class="headerlink" title="æƒ…å†µäºŒï¼š"></a>æƒ…å†µäºŒï¼š</h4><p>è¿˜æ˜¯è‡ªå®šä¹‰GuideListCellä¸­ã€‚æ­£åœ¨æˆ‘ä¸ºäº†æ‰¾åˆ°é—®é¢˜åŸå› å¹¶é¡ºåˆ©è§£å†³æ´‹æ´‹å¾—æ„çš„æ—¶å€™ï¼Œå†æ¬¡è¯·æ±‚æ—¶ï¼ŒåŒæ ·çš„é”™è¯¯åˆå‘ç”Ÿäº†ï¼Œä¸åŒçš„åªæ˜¯è¿™æ¬¡æŠ¥é”™çš„IDå’Œä¸Šæ¬¡ä¸ä¸€æ ·ï¼Œä½†é”™è¯¯æ ¼å¼è¿˜æ˜¯ä¸€æ¯›ä¸€æ ·ã€‚ä½†åˆšæ‰åˆ†æ˜æ˜¯å¥½äº†çš„ï¼Œç•Œé¢å®Œå®Œæ•´æ•´çš„å±•ç°åœ¨æˆ‘é¢å‰å‘€ã€‚äºæ˜¯æˆ‘åšä¿¡è¿™æ¬¡ä¸è¯¥æ˜¯æˆ‘çš„é—®é¢˜ï¼Œä¸€å®šæ˜¯æ•°æ®é—®é¢˜ï¼Œå†æ¬¡æ‰“å°è¯·æ±‚ç»“æœå‘ç°ï¼Œåå°ä¿®æ”¹äº†è¿”å›æ•°æ®ï¼Œåˆ é™¤äº†nameå­—æ®µï¼Œä½†æ˜¯æˆ‘ä¾ç„¶è¿˜åœ¨å–rowData.name å­—æ®µï¼Œè¿™æ—¶ï¼Œnameå­—æ®µå·²ç»ä¸å­˜åœ¨äº†ï¼Œå½“ç„¶ä¼šæŠ¥é”™ã€‚è¿™ä¸ªé”…åå°Javaå¤§å”ä¹‰ä¸å®¹è¾çš„ç»™èƒŒäº†ã€‚</p>
<h4 id="æƒ…å†µä¸‰ï¼š"><a href="#æƒ…å†µä¸‰ï¼š" class="headerlink" title="æƒ…å†µä¸‰ï¼š"></a>æƒ…å†µä¸‰ï¼š</h4><p>ç²˜æ®µä»£ç å…ˆï¼Œ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line">return (</div><div class="line">            &lt;View&gt;         </div><div class="line">                &#123;this.state.showEmptyView ?</div><div class="line">                    &lt;EmptyView/&gt;</div><div class="line">                    :</div><div class="line">                    &lt;View style=&#123;styles.listViewContainer&#125;&gt;</div><div class="line">                   this.state.dataSource &amp;&amp;</div><div class="line">                    &lt;ListView</div><div class="line">                    opacity=&#123;1&#125;</div><div class="line">                    dataSource=&#123;this.state.dataSource&#125;</div><div class="line">                    renderRow=&#123;ExplicitGuideCell.bind(null,this.updateDownloadStatus)&#125;</div><div class="line">                    showVerticalScrollIndicator=&#123;false&#125;</div><div class="line">                    enableEmptySections=&#123;true&#125;</div><div class="line">                    onEndReached=&#123;this.loadMoreData&#125;</div><div class="line">                    onEndReachedThreshold=&#123;20&#125;</div><div class="line">                    renderSeparator=&#123;(sectionID, rowID) =&gt; &#123;</div><div class="line">                        return (</div><div class="line">                            &lt;View</div><div class="line">                                key=&#123;`$&#123;sectionID&#125;-$&#123;rowID&#125;`&#125;</div><div class="line">                                style=&#123;&#123;</div><div class="line">                                    height: 0,</div><div class="line">                                    width: App.Constant.screenWidth,</div><div class="line">                                    marginTop: 10,</div><div class="line">                                &#125;&#125; /&gt;</div><div class="line">                        );</div><div class="line">                    &#125; &#125;</div><div class="line">                    /&gt;</div><div class="line">                &lt;/View&gt;</div><div class="line">                &#125;</div><div class="line">                &lt;/View&gt;</div><div class="line">                &lt;/Image&gt;</div><div class="line">            &lt;/View&gt;</div><div class="line">        );</div></pre></td></tr></table></figure>
<p>è¿™æ®µä»£ç é€»è¾‘å¾ˆç®€å•ï¼Œå°±æ˜¯å¦‚æœè¯·æ±‚å›æ¥çš„æ•°æ®ä¸ºç©ºæ—¶ï¼Œæ˜¾ç¤ºç©ºé¡µé¢ï¼Œå¦åˆ™ï¼Œåˆ¤æ–­this.state.datasource æ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨å°±æ˜¾ç¤ºListViewã€‚<br>reload ä¸€ä¸‹ï¼Œåˆæ˜¯é‚£ä¸ªç†Ÿæ‚‰çš„çº¢è‰²ç•Œé¢ï¼ŒèƒŒå¿ƒä¸€é˜µå¯’æ„ï¼Œè¿™ä¹ˆç®€å•çš„ç•Œé¢æ€ä¹ˆåˆé”™äº†ï¼Œç§¯ç´¯äº†å‰ä¸¤æ¬¡çš„ç»éªŒï¼Œæˆ‘æŠŠimportä¸­çš„ç»„ä»¶éƒ½æ£€æŸ¥äº†ä¸€éï¼Œç”¨åˆ°çš„éƒ½å¯¼å…¥äº†ï¼Œæ•°æ®è¯·æ±‚æˆåŠŸåä¹Ÿç»™this.state è®¾ç½®äº†æ•°æ®ï¼Œä¸ºä»€ä¹ˆè¿˜æŠ¥é”™å‘¢ï¼Ÿ<br>çš„ç¡®ï¼Œè¿™é‡Œæœ‰ä¸¤å±‚æ¡ä»¶åˆ¤æ–­ï¼Œä¸€ä¸ªç–å¿½å°±ä¼šå‡ºé—®é¢˜ï¼Œæ‰€ä»¥æˆ‘è¿˜æ˜¯ä¸å»ºè®®åœ¨return ç»„ä»¶ä¸­è¿›è¡Œå¤ªå¤æ‚çš„é€»è¾‘åˆ¤æ–­ã€‚<strong>é”™è¯¯åŸå› ç«Ÿæ˜¯ä¸€å¯¹èŠ±æ‹¬å·</strong></p>
<p>äºŒå±‚é€»è¾‘åˆ¤æ–­ <code>this.state.dataSource &amp;&amp;</code> å‰åå¿˜è®°äº†èŠ±æ‹¬å·ã€‚</p>
<blockquote>
<p>ç»¼ä¸Šæ‰€è¿°ï¼Œä¸éš¾çœ‹å‡ºä»¥ä¸Šä¸‰ç§æƒ…å†µéƒ½æŠ¥äº†åŒæ ·çš„é”™è¯¯ï¼Œä¸åŒçš„åªæ˜¯IDã€‚è™½ç„¶é”™è¯¯ä¿¡æ¯è®©ä½ è¿·èŒ«ï¼Œä½†è¿™ä¸‰ç§æƒ…å†µéƒ½å‡ºç°åœ¨æ¸²æŸ“ç•Œé¢çš„æ—¶å€™ï¼Œæ‰€ä»¥å‡ä¸returnï¼ˆï¼‰æ–¹æ³•ç›¸å…³ã€‚</p>
<p>ä»¥åè‹¥æ˜¯åœ¨é‡åˆ°è¿™ç§é”™è¯¯ï¼Œä¸å¦¨å¤šåœ¨æ¸²æŸ“ç•Œé¢çš„æ–¹æ³•ä¸­æ‰¾æ‰¾åŸå› å§ï¼</p>
</blockquote>
<h3 id="é—®é¢˜äºŒï¼š"><a href="#é—®é¢˜äºŒï¼š" class="headerlink" title="é—®é¢˜äºŒï¼š"></a>é—®é¢˜äºŒï¼š</h3><p>æœ‰è¿™æ ·ä¸€ä¸ªç•Œé¢</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1614000-785f930caceb782f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="åˆ—è¡¨.png"></p>
<p>ä¸€ä¸ªåˆ—è¡¨ä¸­çš„cellé‡Œé¢åˆæ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œå¹¶ä¸”é‡Œå±‚çš„åˆ—è¡¨å¯ä»¥å‘å·¦æ»‘åŠ¨æµè§ˆã€‚<br>æˆ‘çš„æƒ³æ³•å°±æ˜¯ï¼Œå¤–é¢ä¸€ä¸ªListViewï¼Œåœ¨è¿™ä¸ªListViewçš„Cellé‡Œé¢åˆæ˜¯ä¸€ä¸ªæ¨ªå‘æ»‘åŠ¨çš„ListViewã€‚æ‰¾åˆ°æ€è·¯äº†é‚£å°±å¼€å·¥å§ï¼</p>
<p>ç»“æœæ˜¯åœ¨ react-native ä¸­ä¸èƒ½ç›´æ¥åµŒå¥—ä½¿ç”¨ ListViewï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸å¯ä»¥åœ¨é¦–å±‚çš„ListViewçš„Cell ä¸­ç›´æ¥å†åµŒå¥—ä¸€ä¸ª ListViewï¼Œå°±åƒè¿™æ ·</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">const GuideListCell = (rowData, sectionID, rowID) =&gt; &#123;</div><div class="line">   const name = rowData.name;</div><div class="line">   return (</div><div class="line">     &lt;View style = &#123;styles.container&#125;&gt;</div><div class="line">        &lt;Text style = &#123;styles.title&#125;&gt;</div><div class="line">        &#123;name&#125;</div><div class="line">        &lt;/Text&gt;</div><div class="line">      &lt;View style = &#123;styles.listContainer&#125;&gt;</div><div class="line">      &lt;ListVeew </div><div class="line">       dataSource = &#123;rowData&#125;</div><div class="line">       renderRow = &#123;CustomerCell&#125; </div><div class="line">       /&gt;</div><div class="line">      &lt;/View&gt;</div><div class="line">     &lt;/View&gt;</div><div class="line">);</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>äº²èº«è¯•éªŒè¿™æ ·æ˜¯ä¸è¡Œçš„,å…·ä½“æŠ¥é”™ä¿¡æ¯æå¿˜äº†ğŸ˜‚</p>
<h5 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h5><p>ä¸èƒ½ç›´æ¥åµŒå¥—ï¼Œé‚£æˆ‘å°±é—´æ¥åµŒå¥—å‘—ï¼å…ˆç”¨ä¸€ä¸ªViewæŠŠäºŒå±‚çš„ListViewå°è£…è¿›å»ï¼Œç„¶ååœ¨ä¸€å±‚çš„ListView Cellä¸­è°ƒç”¨è¿™ä¸ªç©ºé—´å°±è¡Œå•¦ï¼</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">const GuideListCell = (rowData, sectionID, rowID) =&gt; &#123;</div><div class="line">   const name = rowData.name;</div><div class="line">   return (</div><div class="line">     &lt;View style = &#123;styles.container&#125;&gt;</div><div class="line">        &lt;Text style = &#123;styles.title&#125;&gt;</div><div class="line">        &#123;name&#125;</div><div class="line">        &lt;/Text&gt;</div><div class="line">      &lt;View style = &#123;styles.listContainer&#125;&gt;</div><div class="line">        &lt;CloudGuideContainer dataSource = &#123;rowData&#125; /&gt;</div><div class="line">      &lt;/View&gt;</div><div class="line">     &lt;/View&gt;</div><div class="line">);</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>å…¶ä¸­CloudGuideContainer å°±æ˜¯é‚£ä¸ªåŒ…è£¹ï¼Œç”¨æ¥åŒ…è£¹äºŒå±‚ListView</p>
<p>æ¥çœ‹çœ‹è¿™ä¸ªåŒ…è£¹çš„çœŸé¢ç›®å§ï¼</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line">import React from &apos;react&apos;; // eslint-disable-line no-unused-vars</div><div class="line">import &#123;</div><div class="line">  View,</div><div class="line">  ListView,</div><div class="line">&#125; from &apos;react-native&apos;;</div><div class="line"></div><div class="line">import App from &apos;.././helper/app.js&apos;;</div><div class="line">import CloudGuideCell from &apos;./CloudGuideCell.js&apos;;</div><div class="line"></div><div class="line">const Constants = &#123;</div><div class="line">  height: App.Constant.screenWidth * 0.4776,</div><div class="line">&#125;;</div><div class="line"></div><div class="line">const CloudGuideContainer = (&#123;dataSource&#125;) =&gt; &#123;</div><div class="line">    const ds = new ListView.DataSource(&#123; rowHasChanged: (r1, r2) =&gt; r1 !== r2 &#125;);</div><div class="line">    const guideDataSource = ds.cloneWithRows(dataSource.items);</div><div class="line">    return (</div><div class="line">        &lt;ListView</div><div class="line">            style = &#123;&#123;overflow: &apos;visible&apos;,&#125;&#125;</div><div class="line">            enableEmptySections=&#123;true&#125;</div><div class="line">            showsHorizontalScrollIndicator=&#123;false&#125;</div><div class="line">            horizontal=&#123;true&#125;</div><div class="line">            dataSource=&#123;guideDataSource&#125;</div><div class="line">            renderRow=&#123;CloudGuideCell&#125;</div><div class="line">            renderSeparator=&#123;(sectionID, rowID) =&gt; &#123;</div><div class="line">                return (</div><div class="line">                    dataSource.items.length &gt; 1 ?</div><div class="line">                    &lt;View</div><div class="line">                    key=&#123;`$&#123;sectionID&#125;-$&#123;rowID&#125;`&#125;</div><div class="line">                    style=&#123;&#123;</div><div class="line">                        width: 10,</div><div class="line">                         height: Constants.height,</div><div class="line">                    &#125;&#125; /&gt; : null</div><div class="line">                );</div><div class="line">                &#125; &#125;</div><div class="line">            /&gt;</div><div class="line">        );</div><div class="line">&#125;;</div><div class="line"></div><div class="line">export default CloudGuideContainer;</div></pre></td></tr></table></figure>
<p>æœºæ™ºå¦‚æˆ‘ï¼Œå“ˆå“ˆğŸ˜„</p>
<h3 id="é—®é¢˜ä¸‰ï¼š"><a href="#é—®é¢˜ä¸‰ï¼š" class="headerlink" title="é—®é¢˜ä¸‰ï¼š"></a>é—®é¢˜ä¸‰ï¼š</h3><p>å…³äºthis.state,ä¸å¤ªäº†è§£çš„å»ºè®®ç›´æ¥çœ‹<a href="http://reactnative.cn/docs/0.40/state.html#content" target="_blank" rel="external">å®˜æ–¹æ–‡æ¡£</a></p>
<p>æˆ‘é‡åˆ°åˆ°é—®é¢˜æ˜¯è¿™æ ·çš„ï¼Œæœ‰ä¸€ä¸ªåˆ—è¡¨æ•°æ®å¾ˆå¤šï¼Œéœ€è¦åˆ†é¡µè¯·æ±‚ï¼Œå› æ­¤æˆ‘åœ¨this.state ä¸­å£°æ˜ä¸€ä¸ªå˜é‡ page åˆå§‹å€¼ä¸º 0 ï¼Œæ¯æ¬¡è¯·æ±‚çš„æ—¶å€™ç»™stateçš„pageåŠ ä¸€ï¼Œç›´åˆ°this.state.data.length === this<br>.state.data.total çš„æ—¶å€™åœæ­¢è¯·æ±‚ç›´æ¥returnï¼Œè¿™ä¸ªåšæ³•çœ‹ä¸Šå»æ˜¯æ²¡æœ‰çš„é—®é¢˜çš„ï¼Œä½†æ˜¯åœ¨ç‰¹æ®Šæƒ…å†µä¸‹å°±å›å‘ç”Ÿé”™è¯¯ï¼Œæ¯”å¦‚ä¸‹å›¾æ˜¯ä¸€ä¸ªæœç´¢åŠŸèƒ½ï¼Œå½“è¾“å…¥å…³é”®å­—åç‚¹å‡»æœç´¢å°†ä¼šè¯·æ±‚æ•°æ®ã€‚ä½†æ˜¯ä¼šæœ‰è¿™ç§æƒ…å†µï¼Œå½“æˆ‘è¾“å®Œå…³é”®å­—åæœç´¢äº†å‡ é¡µæ•°æ®åï¼Œæˆ‘ç‚¹å‡»TextInputï¼Œä½†æ˜¯æ²¡æœ‰ä¿®æ”¹å…³é”®å­—ï¼Œå†æ¬¡ç‚¹å‡»æœç´¢è¿™æ—¶æˆ‘çš„pageåº”è¯¥ä»1å¼€å§‹æ‰å¯¹ï¼Œå¯å®éªŒè¯æ˜ï¼Œpageä¼šä»ä¸Šä¸€æ¬¡çš„è®¡æ•°å€¼å¾€ä¸ŠåŠ 1ï¼Œè€Œä¸æ˜¯ä»1å¼€å§‹ã€‚</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1614000-09c8fa6cdb257ca4.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="æœç´¢.jpg"></p>
<p>ä¸‹é¢ç²˜ä¸Šéƒ¨åˆ†ç›¸å…³ä»£ç </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div></pre></td><td class="code"><pre><div class="line">export default class SearchDetail extends React.Component &#123;</div><div class="line">    constructor(props)&#123;</div><div class="line">        super(props);</div><div class="line">        this.state = &#123;</div><div class="line">            title: props.title,</div><div class="line">            keyword: props.keyword,</div><div class="line">            contentStr:props.keyword,</div><div class="line">            cellType:undefined,</div><div class="line">            data: undefined,</div><div class="line">            dataSource: undefined,</div><div class="line">            showEmptyView:false,</div><div class="line">            fetchingData:false,</div><div class="line">            page:0,</div><div class="line">        &#125;;</div><div class="line">   &#125;</div><div class="line">   </div><div class="line">   // è¯·æ±‚æ•°æ®</div><div class="line">	 async fetchData (keyword) &#123;</div><div class="line">      var urlStr;</div><div class="line">      var cell;</div><div class="line">      const nextIndex = this.state.page + 1;</div><div class="line">      this.setState(&#123;</div><div class="line">        cellType: cell,</div><div class="line">        fetchingData:true,</div><div class="line">      &#125;);</div><div class="line">      try &#123;</div><div class="line">            const result = await App.Request.get(&#123;</div><div class="line">                url: urlStr,</div><div class="line">                parameters: &#123;</div><div class="line">                    page: nextIndex,</div><div class="line">                    limit: App.Constant.limit,</div><div class="line">                    keyword:keyword,</div><div class="line">                &#125;</div><div class="line">            &#125;);</div><div class="line">            this.updateDataSource(result);</div><div class="line">        &#125; catch (error) &#123;</div><div class="line">            this.setState(&#123;</div><div class="line">                data: [],</div><div class="line">                offline: true,</div><div class="line">                fetchingVoices: false,</div><div class="line">            &#125;);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    // ç‚¹å‡»æœç´¢</div><div class="line">     submitKeyWords(text) &#123;</div><div class="line">        this.setState(&#123;</div><div class="line">            showEmptyView:false,</div><div class="line">            dataSource:undefined,</div><div class="line">            data:undefined,,</div><div class="line">            page:0</div><div class="line">        &#125;);</div><div class="line">        this.fetchData(text);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>æˆ‘å…ˆæœç´¢æ­¦ä¾¯ç¥ ç›¸å…³æ•°æ®ï¼Œè¯·æ±‚ä¸‰é¡µ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">2017-01-12 14:31:21.210 [info][tid:com.facebook.react.JavaScript] &apos;---&gt;&gt; page&apos;, 1</div><div class="line">2017-01-12 14:31:21.210172 [5377:3542880] &apos;---&gt;&gt; page&apos;, 1</div><div class="line">2017-01-12 14:31:25.409 [info][tid:com.facebook.react.JavaScript] &apos;---&gt;&gt; page&apos;, 2</div><div class="line">2017-01-12 14:31:25.409329 [5377:3542880] &apos;---&gt;&gt; page&apos;, 2</div><div class="line">2017-01-12 14:31:27.649 [info][tid:com.facebook.react.JavaScript] &apos;---&gt;&gt; page&apos;, 3</div><div class="line">2017-01-12 14:31:27.652452 [5377:3542880] &apos;---&gt;&gt; page&apos;, 3</div></pre></td></tr></table></figure>
<p>æ¥ç€æˆ‘ä¸ä¿®æ”¹ä»»ä½•å…³é”®å­—ï¼Œå†æ¬¡ç‚¹å‡»æœç´¢</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[tid:com.facebook.react.JavaScript] &apos;---&gt;&gt; page&apos;, 4</div><div class="line">2017-01-12 14:31:57.153670 [5377:3542880] &apos;---&gt;&gt; page&apos;, 4</div></pre></td></tr></table></figure>
<p>pageå¹¶æ²¡æœ‰å¦‚æˆ‘æ‰€æ„¿çš„ä»1å¼€å§‹ã€‚ä¹Ÿå°±æ˜¯è¯´æˆ‘åœ¨submitKeyWords(text)æ–¹æ³•ä¸­ï¼Œåœ¨fetchDataä¹‹å‰ç»™å°†stateä¸­çš„pageè®¾ä¸º0ï¼Œå¹¶æ²¡æœ‰èµ·ä½œç”¨ã€‚è¯´ä¸èµ·ä½œç”¨å¯èƒ½æœ‰äº›ä¸å¦¥ï¼Œåªèƒ½è¯´åœ¨æˆ‘ç”¨stateçš„pageçš„æ—¶å€™å®ƒè‡³å°‘è¿˜ä¸ä¸º0ã€‚å› æ­¤æˆ‘æ¨æ–­this.setStateæ–¹æ³•å¯èƒ½æ˜¯å¼‚æ­¥çš„ã€‚äºæ˜¯æˆ‘googleäº†ä¸€ä¸‹æœä¸å…¶ç„¶</p>
<blockquote>
<p>State Updates May Be Asynchronous<br>React may batch multiple setState() calls into a single update for performance.</p>
<p>Because this.props and this.state may be updated asynchronously, you should not rely on their values for calculating the next state.</p>
</blockquote>
<p>æ–‡æ¡£åœ°å€<a href="https://facebook.github.io/react/docs/state-and-lifecycle.html" target="_blank" rel="external">https://facebook.github.io/react/docs/state-and-lifecycle.html</a></p>
<p>å¥½äº†ï¼Œæ‰¾åˆ°é—®é¢˜çš„åŸå› äº†ï¼Œé‚£æ€ä¹ˆè§£å†³å‘¢ï¼Ÿå¦‚æœåœ¨OCä¸­æˆ‘ä¸€å®šä¼šå£°æ˜ä¸€ä¸ªå±æ€§æ¥åšè¿™ä»¶äº‹ï¼Œé‚£ä¸å¦¨ä¹Ÿåœ¨reactä¸­è¯•ä¸€è¯•ï¼Œçœ‹æ˜¯å¦å¯è¡Œã€‚æ”¹ä¸€ä¸‹ä»£ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div></pre></td><td class="code"><pre><div class="line">export default class SearchDetail extends React.Component &#123;</div><div class="line">    constructor(props)&#123;</div><div class="line">        super(props);</div><div class="line">        this.page = 0;</div><div class="line">        this.state = &#123;</div><div class="line">            title: props.title,</div><div class="line">            keyword: props.keyword,</div><div class="line">            contentStr:props.keyword,</div><div class="line">            cellType:undefined,</div><div class="line">            data: undefined,</div><div class="line">            dataSource: undefined,</div><div class="line">            showEmptyView:false,</div><div class="line">            fetchingData:false,</div><div class="line">        &#125;;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">  async fetchData (keyword) &#123;</div><div class="line">      var urlStr;</div><div class="line">      var cell;</div><div class="line">      const nextIndex = this.page + 1;</div><div class="line">      this.setState(&#123;</div><div class="line">        cellType: cell,</div><div class="line">        fetchingData:true,</div><div class="line">      &#125;);</div><div class="line">      this.page = nextIndex;</div><div class="line">      try &#123;</div><div class="line">            const result = await App.Request.get(&#123;</div><div class="line">                url: urlStr,</div><div class="line">                parameters: &#123;</div><div class="line">                    page: nextIndex,</div><div class="line">                    limit: App.Constant.limit,</div><div class="line">                    keyword:keyword,</div><div class="line">                &#125;</div><div class="line">            &#125;);</div><div class="line">            this.updateDataSource(result);</div><div class="line">        &#125; catch (error) &#123;</div><div class="line">            this.setState(&#123;</div><div class="line">                data: [],</div><div class="line">                offline: true,</div><div class="line">                fetchingVoices: false,</div><div class="line">            &#125;);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">  submitKeyWords(text) &#123;</div><div class="line">        this.setState(&#123;</div><div class="line">            showEmptyView:false,</div><div class="line">            dataSource:undefined,</div><div class="line">            data:undefined,</div><div class="line">        &#125;);</div><div class="line">        this.page = 0;</div><div class="line">        this.fetchData(text);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>reload ä¸€ä¸‹ï¼ŒæˆåŠŸï¼æ¯å½“æˆ‘ç‚¹å‡»æœç´¢æŒ‰é’®pageéƒ½ä¼šå…ˆè¢«ç½®ä¸º0ã€‚</p>
<h4 id="é—®é¢˜å››ï¼š"><a href="#é—®é¢˜å››ï¼š" class="headerlink" title="é—®é¢˜å››ï¼š"></a>é—®é¢˜å››ï¼š</h4><p>ä½ æ˜¯æ€ä¹ˆè®¾æ–½Textç»„ä»¶çš„èƒŒæ™¯è‰²é€æ˜å‘¢ï¼Ÿ</p>
<p>ä¸€å¼€å§‹æˆ‘ç”¨äº†ä¸€ç§å¾ˆç¬¨çš„æ–¹æ³• <code>backgroundColor: App.Color.white.alpha(0)</code> ç®€ç›´è¦è¢«è‡ªå·±è ¢å“­äº†</p>
<p>æœ‰æ¬¡æ— æ„ä¸­çœ‹åˆ°åˆ«äººçš„æ–¹æ³•<br><code>backgroundColor: &#39;transparent&#39;</code><br>å­¦ä¹ äº†!</p>


                
            </div>

            <!-- Comments -->
            
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    


                </div>
            
        </div>
    </div>
</article>

    <!-- Footer -->
    <hr />

<!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    

                    

                    
                        <li>
                            <a href="https://github.com/Jeavil/Jeavil.github.io" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    

                    

                    
                </ul>
                <p class="copyright text-muted">Original Theme <a target="_blank" href="http://startbootstrap.com/template-overviews/clean-blog/">Clean Blog</a> from <a href="http://startbootstrap.com/" target="_blank">Start Bootstrap</a></p>
                <p class="copyright text-muted">Adapted for <a target="_blank" href="https://hexo.io/">Hexo</a> by <a href="http://www.codeblocq.com/" target="_blank">Jonathan Klughertz</a></p>
            </div>
        </div>
    </div>
</footer>


    <!-- After footer scripts -->
    
<!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Bootstrap -->
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

<!-- Gallery -->
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Disqus Comments -->



</body>

</html>